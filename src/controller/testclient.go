package controller

import (
	"fmt"
	"github.com/ybbus/jsonrpc"
	"strconv"
	"utils"
)

type account struct {
	pubkeypem    string
	prikeyhex    string
	pubkeyhex    string
}

type testClient struct {
	url string
}

var adminAcc account
var adminAcc2 account
var adminAcc3 account

var acc account
var acc2 account
var acc3 account
var acc4 account
var acc5 account
var acc6 account

var tc testClient
var tc2 testClient
var tc3 testClient

func InitTest() {
	//acc.prikeyhex = "30820277020100300d06092a864886f70d0101010500048202613082025d02010002818100ece10d27f9eaecbdd5268e865715521c12634c7a1fe70fd4128147f3a5cfc86fd50660266daba2affb760d815cc132a2cafb904bde1c909e12cfa89eaf841abcce1936524c783ce5c6cd8b8b60b47050e14d17a9232e061b21d7b60746780e5bb7142b437ad1867e439deebfb6eea55892d98d95e29c8e2cbfe96a8141962665020301000102818100c3ce000f0471e1c1c558bac56764935beb0333eb5b45a77ad8d50ec1e3550f4d09dcdc4bc7a9f1afe07fa40843c0db775fac7489920f30a7c9cae78a4c71399b32e5c3405bef3ba8ecc09f39ee9444b488ab46bd1db6d35f66b53033d067934a3aa9afe4fe820f7e2877dc570b12139bf67b7ae130012d2166b0d0162cfa0081024100f9da26c8b25c8f508da7fa4961bfe917a9b5f296352f75cb10b52149f5ee4366ba93284a4f62797d748ba968da0bfdff575d3993d8b4888d5e476d2d001134a1024100f2b52e5de3a8c81dccf4cc9f76e9e3b92e1082b0e3e42e26c8a09cfc55151adf5f258440cb2fed1bea4461cd53b5c57e347d5b4be1a9513bf4a0562f45e89745024049cfc1bf6eb9db78dfb06d477a8238794e20bb5ed6ad83ae0eec83be16d261c51a7f58dac323036325a810cf320372f1193d28425e35cf557c31bbb61c9bf8a1024100d31b5cd535ac1d442e7dcf6df4d4c3cad29271dac29e3ab66953aab8a098d6e2ebb38a31818a9246f1a1c120036bdbf84657b30d719f009591d5d4a111c199b1024010dd12bb1707813c3384d18195f346e73640511aa9930945ec49f596a3b5523b913eaff3b87f9b1999a880b777912ebd82fa726cda07e316c4d2a9637b22a8cc"
	//acc.pubkeypem = "-----BEGIN 公钥-----\nMIGJAoGBAOzhDSf56uy91SaOhlcVUhwSY0x6H+cP1BKBR/Olz8hv1QZgJm2roq/7\ndg2BXMEyosr7kEveHJCeEs+onq+EGrzOGTZSTHg85cbNi4tgtHBQ4U0XqSMuBhsh\n17YHRngOW7cUK0N60YZ+Q53uv7bupViS2Y2V4pyOLL/paoFBliZlAgMBAAE=\n-----END 公钥-----"

	adminAcc.prikeyhex = "30820278020100300d06092a864886f70d0101010500048202623082025e0201000281810098a993a281e540f572dcbf4bc600c331a75f002f7ce19a99d4563ea9fd3d247ffbc67c950693fec11e630996c033d1de0a903e06de07418ad7052bf6507cbae3596a9bbcc245c6f6e7c21a244f602c2b4cbd7089b241728668f8368399e2d8788cb16c2dd5062b6a1aa98ced6ef0120a6dad33438ea64385d157c5f4db8ef05f020301000102818004d561aa448898aceccd167574b87375b001ef0491e4a6bb7620a0ed4aea53ac85b13c228fc9c1c82589273591b25253c06bdebae2eec1e17e7b586ffd0e65f05e503680c3a9a74b403888ad882f802ef77317c9eba8ce4e99bb5d074a23103aa5ed5a357353545fc775b042b2d890e1069ba7410ae5f7522bd322bc7fc22ff1024100c279d0513c53b8c328a6d0844411fccf2a00346d5416053369e7eb8c52299035a5ac7b646edb6c3e4cf0fed8030f0dca2ba17c6520003d4dc565fa8eb45a4e39024100c8f561d0ab46b1ee3945dd2bf77030c86128a9e95bfb8ff128073158d92337064e87938a69a608b0342fc4b0bc492d82145053b6cf7ee3498c370fab6d913357024100a8e711252cc6ede619ad5fd630248b34059f6de9322979d4e07b3b99805676d8110ecf9037b3bcbc13290fbcde5339bfc7cb15f5e228331613867169757c2509024100bac2211776358b22a3a363fa7a488f6d89adeaca6eab89884af4f44d67eeac327644d53f2b141cbaf4a4f81c6fbf6a459b6f537d6fb4b2b22556fe7f08a28a9d02410082899d66d93c2fa93976f087e04358acc4f2cc88c71d4caa24bfb7ebf18e9b66336b7ae48767ab2ee4051d9f247a28550b2b1e1c7be653423817280120f78792"
	adminAcc.pubkeyhex = "30819f300d06092a864886f70d010101050003818d003081890281810098a993a281e540f572dcbf4bc600c331a75f002f7ce19a99d4563ea9fd3d247ffbc67c950693fec11e630996c033d1de0a903e06de07418ad7052bf6507cbae3596a9bbcc245c6f6e7c21a244f602c2b4cbd7089b241728668f8368399e2d8788cb16c2dd5062b6a1aa98ced6ef0120a6dad33438ea64385d157c5f4db8ef05f0203010001"
	adminAcc.pubkeypem = "-----BEGIN 公钥-----\nMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCYqZOigeVA9XLcv0vGAMMxp18A\nL3zhmpnUVj6p/T0kf/vGfJUGk/7BHmMJlsAz0d4KkD4G3gdBitcFK/ZQfLrjWWqb\nvMJFxvbnwhokT2AsK0y9cImyQXKGaPg2g5ni2HiMsWwt1QYrahqpjO1u8BIKba0z\nQ46mQ4XRV8X0247wXwIDAQAB\n-----END 公钥-----"

	adminAcc2.prikeyhex = "30820277020100300d06092a864886f70d0101010500048202613082025d02010002818100be03ff0d4f13904d6cd24eec56552031e5e3b0323c8d6cbdcc968dd122e70c233647888b19111c6412eb0423aff24ee81328c6f49e189d9cc557c379221fc7911b6fd99d91a85fe40592654c230119c8fa2e288bb8acffb7b0949a862ec026fc3cc77ef5b327d4f1018a57453682edf2266a216571992fe18118f131de576c6f020301000102818052560cf8c96122d049ed3f81ad4f29aa358159e20ad7055da0ff43e87185487f2190119ca47a03a1618930bbfe0bb32160dbf48a1ecf6fcc74beb8d70e7052dad079e9243f42b4a5b2afd84213c3413f5d7d3c8e5ae0819eff722b7b0b15d29be9e88ac9d80953fecf736038708b25d9a10974e7e1a8c17255ff598f22d141a1024100d22b9ec87e2940bb80eaae4b0e177d810e713645f20a990bbd241440484e8c5a24f571969f0595bc265c3684f49b73a8c0497a2db50b4f6aad77f42b95adf4b7024100e77345a608a25ebe954ce8fb87477fa9a23ea1b88099ab9a4a5df221daae469e4d5d24a03ac7408578857bc886ac15cd38e1c45bf87a72fac5680e2f2736be09024048aa423ce9b9d3a2c0a0e36019e02f4966b7e7dee91f96e8c31d6d4f0870f7ffd6d571cf74edd6667610dddcbc41df0c52675531e66da1a8ad8f52c19affc92302410084dda19ffcd8e936d31281b4d325f25d792c273e7964be242688e3d5176a7053b3e9c27ad1034d40d1bd1f20305f5d6ca038cab6596041dd3fb1ca62bb4a2bb102410085dc78f8f09dc08fd5a3be3832a1738e9c8267a6d939b772b6168f0b46db174c3505ee188ae4bc93f6bffe8def09edd83327c79cb61005bb716a70b7bffff71d"
	adminAcc2.pubkeyhex = "30819f300d06092a864886f70d010101050003818d0030818902818100be03ff0d4f13904d6cd24eec56552031e5e3b0323c8d6cbdcc968dd122e70c233647888b19111c6412eb0423aff24ee81328c6f49e189d9cc557c379221fc7911b6fd99d91a85fe40592654c230119c8fa2e288bb8acffb7b0949a862ec026fc3cc77ef5b327d4f1018a57453682edf2266a216571992fe18118f131de576c6f0203010001"
	adminAcc2.pubkeypem = "-----BEGIN 公钥-----\nMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQC+A/8NTxOQTWzSTuxWVSAx5eOw\nMjyNbL3Mlo3RIucMIzZHiIsZERxkEusEI6/yTugTKMb0nhidnMVXw3kiH8eRG2/Z\nnZGoX+QFkmVMIwEZyPouKIu4rP+3sJSahi7AJvw8x371syfU8QGKV0U2gu3yJmoh\nZXGZL+GBGPEx3ldsbwIDAQAB\n-----END 公钥-----"

	adminAcc3.prikeyhex = "30820276020100300d06092a864886f70d0101010500048202603082025c02010002818100f87844dcdd09201206b50594b42900b1cfb23794c496ad43380d782b4e3e3806d9a32651fcbaae59809034e6f78f06762a6ed6a58bec6cec24f93c6410abc2179abfb01bcd64d25da9a001025d61cdec09ccedcbf1788322080e2d55b8c22f35cf13949187935853032deb04c787c0d889c55c3cb8d79973add5b20c3871855f0203010001028181008d7cb701e9e01362106dae72e2306313ddc8873bf0c23881897eaa0a46f0c928a56ff11748c9e91450504dbfa402ced4250f9ead0043ae36be4b2aa77492c9df55e0ddd8f9c61d14ca752eeb010d1b822e84e9a6981ddb3ad997786bc9ef3da2392979fbd4d313c00e4deff16f63da24c63d6c9da7b8c9430140cfc2e501fe19024100feb619416a6a30e835505e40d3080a55c0c753ce813e5b9bdcd2644556a987b611a9a3b832179668c2f8c36079db17c950f842d8dcde2d82393a979b11edaed5024100f9ba161a5ed084ff8d39d8b6b74649073eb7c4f3051d92fdca77a309d9a97957dd8c0db1349e6e015e2d9478385f74f10240388f736a20bdaae1b5fb8a89c563024077f02f7c4a2baed3e926eafb036429d9af692ce174a27468b456adb8a8d233815c57d12c0f0a645cf852434dce938863d7a8cf7166af882665e45d373bfdfbf1024041c2d91334a8a07d53494a62433d04fa1d6ff33333c3a7f3a11f841591f5e8f854650f2dfcf7436ca4ca47f0a897aa89d4d7e88d0e0d8275afcc244a0b1f609502405a7a233e10dab885558b3ca596583bc6cc133eded88c95253c721ef3faade5ba934a2c2881122e78a8bb3b132f4975d16e2acdd4157832cbb6698d05cde9fe89"
	adminAcc3.pubkeyhex = "30819f300d06092a864886f70d010101050003818d0030818902818100f87844dcdd09201206b50594b42900b1cfb23794c496ad43380d782b4e3e3806d9a32651fcbaae59809034e6f78f06762a6ed6a58bec6cec24f93c6410abc2179abfb01bcd64d25da9a001025d61cdec09ccedcbf1788322080e2d55b8c22f35cf13949187935853032deb04c787c0d889c55c3cb8d79973add5b20c3871855f0203010001"
	adminAcc3.pubkeypem = "-----BEGIN 公钥-----\nMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQD4eETc3QkgEga1BZS0KQCxz7I3\nlMSWrUM4DXgrTj44BtmjJlH8uq5ZgJA05vePBnYqbtali+xs7CT5PGQQq8IXmr+w\nG81k0l2poAECXWHN7AnM7cvxeIMiCA4tVbjCLzXPE5SRh5NYUwMt6wTHh8DYicVc\nPLjXmXOt1bIMOHGFXwIDAQAB\n-----END 公钥-----"

	acc.prikeyhex = "30820277020100300d06092a864886f70d0101010500048202613082025d02010002818100c812c0fcd9b3b259a9a1438c1a598fe30eb9ec2054082a860f5af692db9fa7ec91f0644d4c32bc5e5b2b48ddcac7dc65fef5a7b49aa047b0265529844e06a60756b0995bbe486920d20564241e214e1e78da26c9ecddc7f7e00ea1567260bcab0b2df15c4adcb12ee0b77325f97c2bfffffabec459c16b18e48d21ae3811f33902030100010281804c6414b9b669cd3c3cef6cfa0e8989cdd92e9600d5f4f43f91975ab4421518a9d4232438fb5217e8330938de2e71d72e3e860f4d7f0899b6a13c3d08de3ddda01c8ac79ce43ccebda7ccaabf09571541b3a62b61fe4807944e91b88dd7b98cb1feddea49705b80f13bd4c7e924a2d50b1c093f88dd72ac0be148371875d58301024100f0c3fa9dddd4ea5e4b3884b8bbbde08ef0537abefaacd3951c55284094e683b820347b461f4a525f659db38948b820bf49aca5621de6ffd65e325680a55f0759024100d4bb9fcc7f7004589d2e778a867dac6e0a112c64e0594e34f88e12d5cc60cb8ed0e867c299a4ab78906926956e70ef16ac80219129644805234fb5c7693eaee102410084720ae7d5244f5957dfdb8314243be7e5e4c65d50e0c9f3f9060f829766c786fe9060500ede7fb9e2d881ef3f85aade0fd55d954005d72f41da4723b5d534e1024030910d3070bfb01e52f432d26b55f1b1c5969a1e05a21ddab60c297caa064732b9baf545563263fb486cd924306c94090724d1850480227919d0aedd71c79fc1024100c28c26c14c6de922bcea51f1f4322ba8fc93d4d318ded22267f72160960b8217186c414ef811809d48689c1a5f263f2c317d7c85109d5b872100fb05a85118ab"
	acc.pubkeyhex = "30819f300d06092a864886f70d010101050003818d0030818902818100c812c0fcd9b3b259a9a1438c1a598fe30eb9ec2054082a860f5af692db9fa7ec91f0644d4c32bc5e5b2b48ddcac7dc65fef5a7b49aa047b0265529844e06a60756b0995bbe486920d20564241e214e1e78da26c9ecddc7f7e00ea1567260bcab0b2df15c4adcb12ee0b77325f97c2bfffffabec459c16b18e48d21ae3811f3390203010001"
	acc.pubkeypem = "-----BEGIN 公钥-----\nMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDIEsD82bOyWamhQ4waWY/jDrns\nIFQIKoYPWvaS25+n7JHwZE1MMrxeWytI3crH3GX+9ae0mqBHsCZVKYROBqYHVrCZ\nW75IaSDSBWQkHiFOHnjaJsns3cf34A6hVnJgvKsLLfFcStyxLuC3cyX5fCv///q+\nxFnBaxjkjSGuOBHzOQIDAQAB\n-----END 公钥-----"

	acc2.prikeyhex = "30820278020100300d06092a864886f70d0101010500048202623082025e02010002818100b90bd280c31cd1d15b5bf6a81a496a3f349bb367604fd910c23450ea8272c1aa6f7b33afdfd807ed2ae4a0f7b3c947c8869975627a4cbb9c9cb4c9112eea087c373fe6ce9cf2fb1028a5e07c6028fab7a36ca524f92a2de511f690eab8d38f1a058915a1f5ffe21f23e72c05fd860a3d03607cf2387a9d82a20dc999c96411fb0203010001028181008d50b2fc7484d0d36242b3f6a2c4882826c3f559301b2a78fae6bb18ac7078e7f0e5148eee926b533adb88f641cda84d42457578b44f5f437605363c3228b63adfd8d36a1ee95f7feee6943354e873e934cf3284a598d4fa523a2f03b58f2e7d1c483c8dde4f6825bb17bede847bc23acea5c84d42e7de0e865a49d87a9e84c1024100f3f5c09cda7fddcb1a43da257d38395bd388f545ddda0ff2cb39104a8149a69c565ef44b207619e9a02d2210ceae79fbc31cb9f5ca281e48ed8a4d5688dbe7e1024100c22dbd3d7f2e10a4f71b6abdf005446fe27c45401a02e4a0870db2f7d5705d19d74259bc8bdd9aa8cccea5ba6ce15c33ae7d5a002f2d54e838a668d650d9455b0241008a967b1b200d2f8427a1901567f33eb269930e32e87aee40712e3390ffad4556dec206697f41582b1df145bee28abf85442bd780479d4ec7031a6420da92824102407c87b4ebb19aab56009bf6b2e5319b985d99f1179116f5e4f57815a4d79f7e35ca5565138467947e590ad6425efd90921c7f8baebe92c5f7400d8902994b1e2d0241008ab30e206027dd59b58abaa21b6c5dd80336a2a83aed4488e22694f3233c1e6117a0c38aa1631f45fa29c4efe820ad3f7c6987fbea1c372787f558a6418fb91f"
	acc2.pubkeyhex = "30819f300d06092a864886f70d010101050003818d0030818902818100b90bd280c31cd1d15b5bf6a81a496a3f349bb367604fd910c23450ea8272c1aa6f7b33afdfd807ed2ae4a0f7b3c947c8869975627a4cbb9c9cb4c9112eea087c373fe6ce9cf2fb1028a5e07c6028fab7a36ca524f92a2de511f690eab8d38f1a058915a1f5ffe21f23e72c05fd860a3d03607cf2387a9d82a20dc999c96411fb0203010001"
	acc2.pubkeypem = "-----BEGIN 公钥-----\nMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQC5C9KAwxzR0Vtb9qgaSWo/NJuz\nZ2BP2RDCNFDqgnLBqm97M6/f2AftKuSg97PJR8iGmXVieky7nJy0yREu6gh8Nz/m\nzpzy+xAopeB8YCj6t6NspST5Ki3lEfaQ6rjTjxoFiRWh9f/iHyPnLAX9hgo9A2B8\n8jh6nYKiDcmZyWQR+wIDAQAB\n-----END 公钥-----"

	acc3.prikeyhex = "30820277020100300d06092a864886f70d0101010500048202613082025d02010002818100cf9d195d985f775f64a77c0728726129d8dffbb723c1b01d5f83878bf94597db0305b18e42a76204d6e4e6ee4e258871c7f833a044a382f6094e344cb6cc8db97fb2e2e7a2fc0d1e9b23cc575fdebb7d1adc312b96c7d25cbf08b2e20f3b3b53744297195904495f8e579241fde2961d5e3b335f344eceedc4289e3914c8192d02030100010281810088c79e938c34b127b6dfa515ee2ed516c5dc6330f82cbe43cbce92f9c403769582fb384c5a5b7e7763c0b0e825b2129fabb8390308d5950d557a2178bd222ce7ee2dbfe9658dadf91e15d631083c0061276f37a2f86472a08ab9c64713a6bd3ad4e6f1d173f2e9747de4487a607ad5e6c638456e2569b7e8efd316acb0994d9d024100f2b58a15e161bdc51c1285ba7de129ce3894a59a2617fc7fce27559561d29c5abcda6212541af848ce654c9194abd9f93ccea3523b6ff109633346f3e5be7cf7024100dafb91541dc20fb3bc94fd1f6426c5c66f715b4de559d701e6976c3f640687ebfc64acd0f58d8b44c0616aa72c799b567c4c8197d50abbf033f1d26e331345fb0240066092c2446bc70ab8d41bc36caf4fe3e544b29d3c470111729f41f66cdd95d22488306f7eda3e8fdb2c7a3891097aeebb944a624cc18239d6eb6fffd4978ebd024020992a7d3720d86d8d3930a527a78df1884d7ba610ea5ad3719c4104fec2ea20fb25918459c9845debb594c6e61c043fcfa923f1924952c8e332b07caf25c359024100e2a6ff8dfafedbcb126b199b9237f03e38522f5d0582c64df4a39943a792116656d03b50f737c9bfc9cacb05d9a70c711632181678631d769bde1fe4feca45dd"
	acc3.pubkeyhex = "30819f300d06092a864886f70d010101050003818d0030818902818100cf9d195d985f775f64a77c0728726129d8dffbb723c1b01d5f83878bf94597db0305b18e42a76204d6e4e6ee4e258871c7f833a044a382f6094e344cb6cc8db97fb2e2e7a2fc0d1e9b23cc575fdebb7d1adc312b96c7d25cbf08b2e20f3b3b53744297195904495f8e579241fde2961d5e3b335f344eceedc4289e3914c8192d0203010001"
	acc3.pubkeypem = "-----BEGIN 公钥-----\nMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDPnRldmF93X2SnfAcocmEp2N/7\ntyPBsB1fg4eL+UWX2wMFsY5Cp2IE1uTm7k4liHHH+DOgRKOC9glONEy2zI25f7Li\n56L8DR6bI8xXX967fRrcMSuWx9Jcvwiy4g87O1N0QpcZWQRJX45XkkH94pYdXjsz\nXzROzu3EKJ45FMgZLQIDAQAB\n-----END 公钥-----"

	acc4.prikeyhex = "30820276020100300d06092a864886f70d0101010500048202603082025c02010002818100ec18b4ab6da8a533db3adfd63a78d9dc240d685c1f724c1491f20a4c394e250ee7addc2066f9cb7b96b6d1f4c89cbfca8938f4048e288efb75e096eb322453785696761e0987a0c09e56f8153665dc24e4914f30eecb29f0b6c13cef068d16ad1c17c6ac44d5b27c894aff1fab20747594db3754d318aeb88f26390336b58b71020301000102818100a8c063eaa01fc9ad0e06bfd504c83a97e1e0ff75d13845eef1fe39a40fd5ae21403181c45b36325e2cf4918f5010d1f93729d128ac5f8b0b6b4ed3305b0fa1e4632ef0d414da7136f1ff98c47797b0cd9cb0533498c82bec65f173a5e572cb091b5323a5c9dd4d2d437e44056c835869b4f682600052bd2c0d9c17459b70913d024100f8be2ed9e82e6073adb84b8fb5461f63991a529fcd9832dc354e49a73004b01740e9bc5d05db720da3e7394460d8b2ae24a18ac90907c2c66147a0212be52143024100f2fc11ab8d89a3737a77b6f9cf56cfe45debb02a6e2600ee350c59f79f0c37262fc17e4a1f58631f50cab02ade97ac48e059cfec90fabde1d2cc84f84d930b3b0240584a391b037ca2a3acbfc3a248b79120ab115ace7a0d51d033e38be519f83000b0fbc5ee46cbf399bfd9accc068c243007b4872c80560ede975cf30b93270b3d02401308e821764f07fcede51ef266e9b8137dc00ee6e4061a208f0b4ea8f54eb1ab4e266c4c4634585f85a6bb324089c537584bf0dbe9679b246bad15e595be252d02403a758c7b25c488f929ca392d5b7d13a902ac959adac284a9f300f69a0fcf574de721960413a234520cf004e816b19b73462f4af901586cd1b6292815e20e7618"
	acc4.pubkeyhex = "30819f300d06092a864886f70d010101050003818d0030818902818100ec18b4ab6da8a533db3adfd63a78d9dc240d685c1f724c1491f20a4c394e250ee7addc2066f9cb7b96b6d1f4c89cbfca8938f4048e288efb75e096eb322453785696761e0987a0c09e56f8153665dc24e4914f30eecb29f0b6c13cef068d16ad1c17c6ac44d5b27c894aff1fab20747594db3754d318aeb88f26390336b58b710203010001"
	acc4.pubkeypem = "-----BEGIN 公钥-----\nMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDsGLSrbailM9s639Y6eNncJA1o\nXB9yTBSR8gpMOU4lDuet3CBm+ct7lrbR9Micv8qJOPQEjiiO+3XglusyJFN4VpZ2\nHgmHoMCeVvgVNmXcJOSRTzDuyynwtsE87waNFq0cF8asRNWyfIlK/x+rIHR1lNs3\nVNMYrriPJjkDNrWLcQIDAQAB\n-----END 公钥-----"

	acc5.prikeyhex = "30820276020100300d06092a864886f70d0101010500048202603082025c02010002818100ec14e3a74fe7b43a477ef099de3b34216d88ce590306ade26b50908e5699d07c6b31d203ab44eefc6495d1539556889a6e82a8e55162093de16e8ec26606b4f2d42d7cc7530a6239e158950307fa79af212930f4a85c01ef1bc09a09bb6d9534f8fb5abb2d3f61156afc44db830439bbbc19761f67d40a84fa3add2f93eef299020301000102818100aaabf364dac484abf95210f8fc0b4b05bb9d42a86122ac04db56541b430a520a10a8e4ce583c2e95f2d5c88e2791769246c058ffe7d4fb1f6c6133fde02a8b16fab88eaea4edee839187b8663bd4360bf95166ee542c6dffa2783b1075f2c137e8f681a6180e57cdfc3459b23bd011fe0d59f608767b30cbe851df3d9143316d024100fb515d32a0c513a9f87b220d2598ed811e9d179e07688f96111be4ad63cf789ebf5517b8891d373862671d9c8edb903707c073b3ac3c4d110bd5ed439070ce13024100f07adb85444e6b74b9c797e5b34b79dc9bb3336bd8bf007d8ddb3966bb8ca19c666de2f00066f5537207c8955c0cf75b547d20c6204cd6c012b1c60b61d2e223024030deb988c6ca8bf05969584dc629dec564f697491b97b19434ef7fa057f0583c46687d9c5ccd5997954b07ef11b8906aa30f417086e592f6e59e4becff817011024069907507065a2a5f9e2218f2f3870162af52b612f49dbbf861aa47836a772c867c8c665f96bd9b99dae7c1cc9710f610b881093f0ff4cb1c9bd84028c4f38ee302404dc3edc0f4d4c6dbc29b8de4169610d6a882a470eef1d240e4f23ba744c2c497968b348a0c5b0c7b8b8414d5a939ea6989fded36de3bc2c01bb29f70e6ae7e3d"
	acc5.pubkeyhex = "30819f300d06092a864886f70d010101050003818d0030818902818100ec14e3a74fe7b43a477ef099de3b34216d88ce590306ade26b50908e5699d07c6b31d203ab44eefc6495d1539556889a6e82a8e55162093de16e8ec26606b4f2d42d7cc7530a6239e158950307fa79af212930f4a85c01ef1bc09a09bb6d9534f8fb5abb2d3f61156afc44db830439bbbc19761f67d40a84fa3add2f93eef2990203010001"
	acc5.pubkeypem = "-----BEGIN 公钥-----\nMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDsFOOnT+e0Okd+8JneOzQhbYjO\nWQMGreJrUJCOVpnQfGsx0gOrRO78ZJXRU5VWiJpugqjlUWIJPeFujsJmBrTy1C18\nx1MKYjnhWJUDB/p5ryEpMPSoXAHvG8CaCbttlTT4+1q7LT9hFWr8RNuDBDm7vBl2\nH2fUCoT6Ot0vk+7ymQIDAQAB\n-----END 公钥-----"

	acc6.prikeyhex = "30820275020100300d06092a864886f70d01010105000482025f3082025b02010002818100c44be4bac9dd13de820a60b5609b8f5053b287577f857c900e0ae290d1e5b85bc3712b2e823abab42759c3ebb967d4abc8224e824c82ba0316ce6fb1990e5bc0e01270ecc286d53fa3901a86619b8e2cac30efee043a40dc6bfdb2eb464d2c2a356c64ad25f41d6ca0c8cd9b90c5a5f7fc7298c4b85208b3ef3822f501c29eed0203010001028180240cdc2101d9bc406d1982d14cc0c4fd37a1de014fc6302e34a6031e1dae56c1638f7122c5800bb1f258260730b1c4f91774557ed096619b17a12a1a2fc5d74bae62d3b27fda7226c3f8e18231511ac360e36655b771b1831163b9f6ff4bd3a8da4c71b0f4a334dabbdbf332a03faf5ee332e63011c4e994a060c864843ce101024100d3e3e63421bbb1d87c399cd23d1c213f7c00ff596747f89ce101cb4f50963e3c1c77b092e14b704cfb3bb3409ed6900515ba445df4a34648a69b1b14590e4ef1024100ed28f7ad93d76e961254c20a85963987713681dec36a0d45dcaf4359be036fd47283f9aaae685353305770507e0226bd551d085d10ff6d64b0e3a1135a25c7bd02400e18b34ff48e901e5ee55651864f40c70070f08bfa1b07a72830fe5da076de5d1167c50f807d8c5312c3be0126900fb4c6e545771ab7620da347de5d542f678102402ada5636b51a1e4f5bac990b51ac1d650ddded859505dab41ef6445338f462069f529d906bc74a17240b08ae62b67ccd854da3af3d5d0a2541994007c128467902404b4fc7dd0cb0dfbe4a828233694e43cfe7bd2bc0070c04180ed6bb3a3d229de728a4c068557f9e4f09c52ec41c342807379a77ecc56a4ec5798e05149b2e2dae"
	acc6.pubkeyhex = "30819f300d06092a864886f70d010101050003818d0030818902818100c44be4bac9dd13de820a60b5609b8f5053b287577f857c900e0ae290d1e5b85bc3712b2e823abab42759c3ebb967d4abc8224e824c82ba0316ce6fb1990e5bc0e01270ecc286d53fa3901a86619b8e2cac30efee043a40dc6bfdb2eb464d2c2a356c64ad25f41d6ca0c8cd9b90c5a5f7fc7298c4b85208b3ef3822f501c29eed0203010001"
	acc6.pubkeypem = "-----BEGIN 公钥-----\nMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDES+S6yd0T3oIKYLVgm49QU7KH\nV3+FfJAOCuKQ0eW4W8NxKy6COrq0J1nD67ln1KvIIk6CTIK6AxbOb7GZDlvA4BJw\n7MKG1T+jkBqGYZuOLKww7+4EOkDca/2y60ZNLCo1bGStJfQdbKDIzZuQxaX3/HKY\nxLhSCLPvOCL1AcKe7QIDAQAB\n-----END 公钥-----"

	tc.url = "http://192.168.1.107:18080"
	tc2.url = "http://192.168.1.107:28080"
	tc3.url = "http://192.168.1.107:38080"
}

func (agent *testClient) doHttpJsonRpcCallType1(appdenurl string, method string, args interface{}) (*jsonrpc.RPCResponse, error) {
	rpcClient := jsonrpc.NewClient(agent.url + appdenurl)
	rpcResponse, err := rpcClient.Call(method, args)
	if err != nil {
		return nil, err
	}
	return rpcResponse, nil
}

//return authid,err
func (c *testClient) get_authid() (int64, error) {
	pa := make([]map[string]interface{}, 0)
	var pa0 map[string]interface{}
	pa0 = make(map[string]interface{})
	pa0["sessionid"] = ""
	pa0["idtype"] = 1
	pa = append(pa, pa0)
	res, err := c.doHttpJsonRpcCallType1("/apis/identity", "get_auto_inc_id", pa)
	if err != nil {
		return 0, err
	}
	return res.GetInt()
}

//return mgmtid,err
func (c *testClient) get_mgmtid(sid string, idtp int) (int64, error) {
	pa := make([]map[string]interface{}, 0)
	var pa0 map[string]interface{}
	pa0 = make(map[string]interface{})
	pa0["sessionid"] = sid
	pa0["idtype"] = idtp
	pa = append(pa, pa0)
	res, err := c.doHttpJsonRpcCallType1("/apis/identity", "get_auto_inc_id", pa)
	if err != nil {
		return 0, err
	}
	return res.GetInt()
}

//return session_id,err
func (c *testClient) login(auth_id int64, acc account) (string, error) {
	pa := make([]map[string]interface{}, 0)
	var pa0 map[string]interface{}
	pa0 = make(map[string]interface{})
	pa0["loginid"] = auth_id
	pa0["pubkey"] = acc.pubkeypem
	sigdata := "user_login," + strconv.FormatInt(auth_id, 10)
	sig_res, err := utils.RsaSignWithSha1Hex(sigdata, acc.prikeyhex)
	if err != nil {
		fmt.Println(err)
	}
	fmt.Println(sig_res)
	pa0["signature"] = sig_res
	pa = append(pa, pa0)
	res, err := c.doHttpJsonRpcCallType1("/apis/user", "user_login", pa)
	if err != nil {
		return "", err
	}
	if res.Error != nil {
		println(res.Error.Message)
		return "", nil
	}
	return res.Result.(map[string]interface{})["sessionid"].(string), nil
}
